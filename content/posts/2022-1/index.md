---
title: "Windows自用设置"
date: 2022-01-03T20:00:00+08:00
draft: false
authors: ["zhyoch"]
tags: [Profile,Windows]
featuredImagePreview: ""
summary: 用于系统重装前的备份与重装后的恢复。
---

> 用于系统重装前的备份与重装后的恢复。

## WhyNotWin11

检测是否支持升级Windows11: [https://github.com/rcmaehl/WhyNotWin11/releases/latest](https://github.com/rcmaehl/WhyNotWin11/releases/latest)

## Windows

### ISO下载

最好直接下载ISO, 而不是通过`创建工具`下载。

Windows11: [https://www.microsoft.com/zh-cn/software-download/windows11](https://www.microsoft.com/zh-cn/software-download/windows11)

Windows10: [https://www.microsoft.com/zh-cn/software-download/windows10](https://www.microsoft.com/zh-cn/software-download/windows10)

对于Windows10的下载页面, 如果浏览器UA是PC, 则只有下载`创建工具`一种方式, 切换为手机UA, 页面就会像Windows11的下载页面一样, 有三种下载方式了。

### 激活

适用于Windows10和Windows11: 

https://cmwtat.cloudmoe.com/cn.html 或 https://github.com/TGSAN/CMWTAT_Digital_Edition/releases/latest

## 软件下载

1. [7-zip](https://www.7-zip.org/)

2. Adobe: [官网](https://www.adobe.com/cn/products/catalog.html), [vposy](https://weibo.com/u/1112829033), [GenP](https://www.reddit.com/r/GenP/wiki/redditgenpguides/)

3. [AIDA64](https://www.aida64.com/downloads)

4. [Android Platform Tools](https://developer.android.com/studio/releases/platform-tools)

5. [Apache Tomcat](https://tomcat.apache.org/)

6. [Aria2](https://github.com/aria2/aria2/releases/latest)

7. [Autoruns](https://learn.microsoft.com/en-us/sysinternals/downloads/autoruns)

8. [Captura](https://github.com/MathewSachin/Captura/releases)

9. Clash for Windows: [原版](https://github.com/Fndroid/clash_for_windows_pkg/releases/latest), [中文版](https://github.com/ender-zhao/Clash-for-Windows_Chinese/releases/latest)

10. [Context Menu Manager](https://gitee.com/BluePointLilac/ContextMenuManager)

11. [CrystalDiskInfo & CrystalDiskMark](https://crystalmark.info/en/download/)

12. [DiskGenius](https://www.diskgenius.cn/)

13. [Enable Loopback Utility](https://telerik-fiddler.s3.amazonaws.com/fiddler/addons/enableloopbackutility.exe)

14. [FFmpeg](https://www.ffmpeg.org/download.html)

15. [FileZilla](https://filezilla-project.org/)

16. [Everything](https://www.voidtools.com/zh-cn/)

17. [FastStone Capture](https://www.faststonecapture.cn/download)

18. [Git](https://git-scm.com/downloads)

19. [GitKraken](https://www.gitkraken.com/download)

20. [Google Chrome](https://www.google.cn/intl/zh-CN/chrome/?standalone=1)离线安装版。

21. [Gradle](https://gradle.org/install/)

22. [HEVC扩展​](https://store.rg-adguard.net/), 来自设备制造商的HEVC扩展, ​ProductId: 9n4wgh0z6vhq。

23. [HiBit Uninstaller](https://www.hibitsoft.ir/)

24. [Hugo](https://github.com/gohugoio/hugo/releases/latest), 下载`hugo_extended`

25. [ImageGlass](https://imageglass.org/)

26. [IntelliJ IDEA](https://www.jetbrains.com/zh-cn/idea/download/)

27. [Internet Download Manager](https://www.internetdownloadmanager.com/)+[Crack](https://www.crackingcity.com/idm-crack/)

28. [Kaspersky](https://my.kaspersky.com/)

29. [LockHunter](https://lockhunter.com/)

30. [Lunacy](https://icons8.com/lunacy)

31. [Maven](https://maven.apache.org/download.cgi)

32. [Microsoft 365 E5 Renew Plus](https://e5renew.com/)

33. [Microsoft .NET SDK](https://dotnet.microsoft.com/zh-cn/download/dotnet)

34. [Microsoft Visual C++ Redistributable](https://learn.microsoft.com/zh-CN/cpp/windows/latest-supported-vc-redist)

35. [Microsoft Visual Studio Code](https://code.visualstudio.com/#alt-downloads)

36. [Mi Flash](http://bigota.d.miui.com/tools/MiFlash2018-5-28-0.zip)

37. [Mi Flash Unlock](https://www.miui.com/unlock/download.html)

38. [MusicPlayer2](https://github.com/zhongyang219/MusicPlayer2/releases/latest)

39. [MySQL](https://www.mysql.com/downloads/)

40. [Navicat Premium](https://www.navicat.com.cn/download/navicat-premium)

41. [Node.js](https://nodejs.org/zh-cn/download/current/)

42. [OBS Studio](https://obsproject.com/)

43. [Office Tool Plus](https://otp.landian.vip/zh-cn/)+[GVLKs](https://learn.microsoft.com/en-us/deployoffice/vlactivation/gvlks)+[KMS](https://www.coolhub.top/tech-articles/kms_list.html)

44. [OpenJDK Archived](https://jdk.java.net/archive/)

45. [Oracle JDK Archive](https://www.oracle.com/java/technologies/downloads/archive/)

46. [Pandoc](https://github.com/jgm/pandoc/releases/latest)

47. [Process Explorer](https://learn.microsoft.com/en-us/sysinternals/downloads/process-explorer)

48. [QtScrcpy](https://github.com/barry-ran/QtScrcpy/releases/latest)

49. [Snipaste](https://zh.snipaste.com/)

50. [StarUML](https://staruml.io/download)

51. [Telegram](https://telegram.org/)

52. [TickTick](https://ticktick.com/)

53. [TopMost](https://www.sordum.org/9182/window-topmost-control-v1-2/)

54. [TrafficMonitor](https://gitee.com/zhongyang219/TrafficMonitor)

55. [Typora](https://www.typora.io/)

56. [Uninstall Tool](https://crystalidea.com/uninstall-tool/download) ([Geek Uninstaller](https://geekuninstaller.com/)的Pro版本) 

57. [Ventoy](https://github.com/ventoy/Ventoy/releases/latest)

58. [Victoria HDD](https://hdd.by/victoria/)

59. [VLC](https://www.videolan.org/vlc/)

60. [Windows Defender Control](https://www.sordum.org/9480/defender-control-v2-0/)

61. [Windows Update Blocker](https://www.sordum.org/9470/windows-update-blocker-v1-6/)

62. [阿里云盘](https://www.aliyundrive.com/)

63. [百度网盘](https://pan.baidu.com/download)

64. [百度翻译](https://fanyi.baidu.com/appdownload/download.html)

65. [哔哩下载姬](https://github.com/leiurayer/downkyi/releases/latest)

66. [格式工厂](http://www.pcfreetime.com/formatfactory/CN/index.html)

67. [QQ](https://im.qq.com/download)

68. [腾讯会议](https://meeting.tencent.com/download-center.html)

69. [网易邮箱大师](https://dashi.163.com/download.html)

70. [微信](https://weixin.qq.com/)

## 系统参数

### 环境变量(系统变量)

| 变量             | 值                     |
| ---------------- | ---------------------- |
| CATALINA_BASE    | D:\Tomcat              |
| CATALINA_HOME    | D:\Tomcat              |
| GRADLE_HOME      | D:\Gradle              |
| GRADLE_USER_HOME | E:\GradleRepos         |
| JAVA_HOME        | D:\Java_JDK            |
| MAVEN_HOME       | D:\Maven               |
| MAVEN_OPTS       | -Xms256m -Xmx1024m     |
| NODE_PATH        | D:\NodeJS\node_modules |

#### PATH

{{< admonition type=tip title="技巧" open=true >}}
第一个变量值以`%`开头, 以`;`结束, 比如`%JAVA_HOME%\bin;`, 再次打开`Path`时就会显示为一行, 否则以列表形式显示。
{{< /admonition >}}

```
C:\Windows;
C:\Windows\system32;
C:\Windows\System32\OpenSSH\;
C:\Windows\System32\Wbem;
C:\Windows\System32\WindowsPowerShell\v1.0\;
C:\Program Files\dotnet\;
C:\Program Files (x86)\dotnet\;
C:\Program Files\Intel\Intel(R) Management Engine Components\iCLS\;
C:\Program Files (x86)\Intel\Intel(R) Management Engine Components\iCLS\;
C:\Program Files\Intel\Intel(R) Management Engine Components\DAL;
C:\Program Files (x86)\Intel\Intel(R) Management Engine Components\DAL;
C:\Program Files\Intel\Intel(R) Management Engine Components\IPT;
C:\Program Files (x86)\Intel\Intel(R) Management Engine Components\IPT;
C:\Program Files (x86)\NVIDIA Corporation\PhysX\Common;
D:\Android Platform Tools;
D:\Aria2;
D:\FFmpeg\bin;
D:\Git\cmd;
D:\Gradle\bin;
D:\Hugo;
D:\Microsoft VS Code\bin;
D:\NodeJS;
D:\NodeJS\node_global;
D:\NodeJS\yarn_global;
D:\Pandoc\;
%CATALINA_HOME%\bin;
%CATALINA_HOME%\lib;
%GRADLE_HOME%\bin;
%JAVA_HOME%\bin;
%MAVEN_HOME%\bin;
```

### 任务栏半透明

定位到注册表`HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced`, 新建`DWORD (32位) 值`, 命名为`UseOLEDTaskbarTransparency`, 修改数值数据为**1**(十六进制), 最后重启**explorer.exe**。

### 时间显示秒数

定位到注册表`HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced`, 新建`DWORD (32位) 值`, 命名为`ShowSecondsInSystemClock`, 修改数值数据为**1**(十六进制), 最后重启**explorer.exe**。

{{< admonition type=info title="注意" open=true >}}
Windows10可用, Windows11删除了这项功能, 后来说是要再添加上, 但是时间上还不明确。
{{< /admonition >}}

### 右键菜单检测文件哈希值

#### 添加

将以下内容写入一个`txt`中, 修改文件后缀名保存为`.reg`文件, 双击导入到注册表: 

```
Windows Registry Editor Version 5.00

[HKEY_CLASSES_ROOT\*\shell\Get-FileHash]
"MUIVerb"="Get-FileHash"
"Icon"="imageres.dll,312"
"SubCommands"=""

[HKEY_CLASSES_ROOT\*\shell\Get-FileHash\Shell]

[HKEY_CLASSES_ROOT\*\shell\Get-FileHash\Shell\MD5]
"MUIVerb"="MD5"
"Icon"="imageres.dll,312"

[HKEY_CLASSES_ROOT\*\shell\Get-FileHash\Shell\MD5\command]
@="PowerShell -NoExit Get-FileHash '%1' -Algorithm MD5 | Format-List"

[HKEY_CLASSES_ROOT\*\shell\Get-FileHash\Shell\SHA1]
"MUIVerb"="SHA1"
"Icon"="imageres.dll,312"

[HKEY_CLASSES_ROOT\*\shell\Get-FileHash\Shell\SHA1\command]
@="PowerShell -NoExit Get-FileHash '%1' -Algorithm SHA1 | Format-List"

[HKEY_CLASSES_ROOT\*\shell\Get-FileHash\Shell\SHA256]
"MUIVerb"="SHA256"
"Icon"="imageres.dll,312"

[HKEY_CLASSES_ROOT\*\shell\Get-FileHash\Shell\SHA256\command]
@="PowerShell -NoExit Get-FileHash '%1' -Algorithm SHA256 | Format-List"
```

#### 移除

将以下内容写入一个`txt`中, 修改文件后缀名保存为`.reg`文件, 双击导入到注册表: 

```
Windows Registry Editor Version 5.00

[-HKEY_CLASSES_ROOT\*\shell\Get-FileHash]
```

## 软件参数

### Git

参考[Git Config](https://zhyoch.netlify.app/2020-7/)。

### Google Chrome

禁用Google Chrome Software Report Tool。

`C:\Users\UserName\AppData\Local\Google\Chrome\User Data\SwReporter\`

文件夹属性→安全→高级→禁用继承→从此对象中删除所有继承的权限。

{{< admonition type=quote title="参考链接" open=true >}}
1. [如何禁用 Software-Reporter-Tool](https://www.yikakia.com/%E5%A6%82%E4%BD%95%E7%A6%81%E7%94%A8Software-Reporter-Tool/)
2. [Chrome Enterprise Policy List & Management | Documentation](https://chromeenterprise.google/policies/#ChromeCleanupEnabled)
3. [Chrome Enterprise Policy List & Management | Documentation](https://chromeenterprise.google/policies/#ChromeCleanupReportingEnabled)
{{< /admonition >}}

### Maven

参考[Maven与Gradle的安装与配置](https://zhyoch.netlify.app/2020-2)。

### NodeJS

参考[NodeJS、NPM与Yarn的安装与配置](https://zhyoch.netlify.app/2021-10)。
