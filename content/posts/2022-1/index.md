---
title: "Windows自用设置"
date: 2022-01-03T20:00:00+08:00
draft: false
authors: ["zhyoch"]
tags: [Profile,Windows]
featuredImagePreview: ""
summary: 用于系统重装前的备份与重装后的恢复。
---

> 用于系统重装前的备份与重装后的恢复。

## WhyNotWin11

检测是否支持升级Windows11: [https://github.com/rcmaehl/WhyNotWin11/releases/latest](https://github.com/rcmaehl/WhyNotWin11/releases/latest)

## Windows

### ISO下载

最好直接下载ISO, 而不是通过`创建工具`下载。

Windows11: [https://www.microsoft.com/zh-cn/software-download/windows11](https://www.microsoft.com/zh-cn/software-download/windows11)

Windows10: [https://www.microsoft.com/zh-cn/software-download/windows10](https://www.microsoft.com/zh-cn/software-download/windows10)

对于Windows10的下载页面, 如果浏览器UA是PC, 则只有下载`创建工具`一种方式, 切换为手机UA, 页面就会像Windows11的下载页面一样, 有三种下载方式了。

### 激活

适用于Windows10和Windows11: 

https://cmwtat.cloudmoe.com/cn.html 或 https://github.com/TGSAN/CMWTAT_Digital_Edition/releases/latest

## 软件下载

1. [7-zip](https://www.7-zip.org/)

2. Adobe: [官网](https://www.adobe.com/cn/products/catalog.html), [vposy](https://weibo.com/u/1112829033), [GenP](https://www.reddit.com/r/GenP/wiki/redditgenpguides/)

3. [AIDA64](https://www.aida64.com/downloads)

4. [Android Platform Tools](https://developer.android.com/studio/releases/platform-tools)

5. [Apache Tomcat](https://tomcat.apache.org/)

6. [Aria2](https://github.com/aria2/aria2/releases/latest)

7. [Autoruns](https://learn.microsoft.com/en-us/sysinternals/downloads/autoruns)

8. [Captura](https://github.com/MathewSachin/Captura/releases)

9. Clash for Windows: [原版](https://github.com/Fndroid/clash_for_windows_pkg/releases/latest), [中文版](https://github.com/ender-zhao/Clash-for-Windows_Chinese/releases/latest)

10. [Context Menu Manager](https://gitee.com/BluePointLilac/ContextMenuManager)

11. [CrystalDiskInfo](https://crystalmark.info/en/download/)

12. [DiskGenius](https://www.diskgenius.cn/)

13. [Enable Loopback Utility](https://telerik-fiddler.s3.amazonaws.com/fiddler/addons/enableloopbackutility.exe)

14. [FFmpeg](https://www.ffmpeg.org/download.html)

15. [FileZilla](https://filezilla-project.org/)

16. [Everything](https://www.voidtools.com/zh-cn/)

17. [FastStone Capture](https://www.faststonecapture.cn/download)

18. [Git](https://git-scm.com/downloads)

19. [GitKraken](https://www.gitkraken.com/download)

20. [Google Chrome](https://www.google.cn/intl/zh-CN/chrome/?standalone=1)离线安装版。

21. [Gradle](https://gradle.org/install/)

22. [HiBit Uninstaller](https://www.hibitsoft.ir/)

23. [Hugo](https://github.com/gohugoio/hugo/releases/latest), 下载`hugo_extended`

24. [IntelliJ IDEA](https://www.jetbrains.com/zh-cn/idea/download/)

25. [Internet Download Manager](https://www.internetdownloadmanager.com/)+[Crack](https://www.crackingcity.com/idm-crack/)

26. [Kaspersky](https://my.kaspersky.com/)

27. [LockHunter](https://lockhunter.com/)

28. [Lunacy](https://icons8.com/lunacy)

29. [Maven](https://maven.apache.org/download.cgi)

30. [Microsoft .NET SDK](https://dotnet.microsoft.com/zh-cn/download/dotnet)

31. [Microsoft Visual C++ Redistributable](https://learn.microsoft.com/zh-CN/cpp/windows/latest-supported-vc-redist)

32. [Microsoft Visual Studio Code](https://code.visualstudio.com/#alt-downloads)

33. [Mi Flash](http://bigota.d.miui.com/tools/MiFlash2018-5-28-0.zip)

34. [Mi Flash Unlock](https://www.miui.com/unlock/download.html)

35. [MusicPlayer2](https://github.com/zhongyang219/MusicPlayer2/releases/latest)

36. [MySQL](https://www.mysql.com/downloads/)

37. [Navicat Premium](https://www.navicat.com.cn/download/navicat-premium)

38. [Node.js](https://nodejs.org/zh-cn/download/current/)

39. [OBS Studio](https://obsproject.com/)

40. [Office Tool Plus](https://otp.landian.vip/zh-cn/)+[GVLKs](https://learn.microsoft.com/en-us/deployoffice/vlactivation/gvlks)+[KMS](https://www.coolhub.top/tech-articles/kms_list.html)

41. [OpenJDK Archived](https://jdk.java.net/archive/)

42. [Oracle JDK Archive](https://www.oracle.com/java/technologies/downloads/archive/)

43. [Pandoc](https://github.com/jgm/pandoc/releases/latest)

44. [Process Explorer](https://learn.microsoft.com/en-us/sysinternals/downloads/process-explorer)

45. [QtScrcpy](https://github.com/barry-ran/QtScrcpy/releases/latest)

46. [Snipaste](https://zh.snipaste.com/)

47. [StarUML](https://staruml.io/download)

48. [Telegram](https://telegram.org/)

49. [TickTick](https://ticktick.com/)

50. [TopMost](https://www.sordum.org/9182/window-topmost-control-v1-2/)

51. [TrafficMonitor](https://gitee.com/zhongyang219/TrafficMonitor)

52. [Typora](https://www.typora.io/)

53. [Uninstall Tool](https://crystalidea.com/uninstall-tool/download) ([Geek Uninstaller](https://geekuninstaller.com/)的Pro版本) 

54. [Ventoy](https://github.com/ventoy/Ventoy/releases/latest)

55. [Victoria HDD](https://hdd.by/victoria/)

56. [VLC](https://www.videolan.org/vlc/)

57. [Windows Defender Control](https://www.sordum.org/9480/defender-control-v2-0/)

58. [Windows Update Blocker](https://www.sordum.org/9470/windows-update-blocker-v1-6/)

59. [阿里云盘](https://www.aliyundrive.com/)

60. [百度网盘](https://pan.baidu.com/download)

61. [百度翻译](https://fanyi.baidu.com/appdownload/download.html)

62. [哔哩下载姬](https://github.com/leiurayer/downkyi/releases/latest)

63. [格式工厂](http://www.pcfreetime.com/formatfactory/CN/index.html)

64. [QQ](https://im.qq.com/download)

65. [腾讯会议](https://meeting.tencent.com/download-center.html)

66. [网易邮箱大师](https://dashi.163.com/download.html)

67. [微信](https://weixin.qq.com/)

## 系统参数

### 环境变量(系统变量)

| 变量             | 值                     |
| ---------------- | ---------------------- |
| CATALINA_BASE    | D:\Tomcat              |
| CATALINA_HOME    | D:\Tomcat              |
| GRADLE_HOME      | D:\Gradle              |
| GRADLE_USER_HOME | E:\GradleRepos         |
| JAVA_HOME        | D:\Java_JDK            |
| MAVEN_HOME       | D:\Maven               |
| MAVEN_OPTS       | -Xms256m -Xmx1024m     |
| NODE_PATH        | D:\NodeJS\node_modules |

#### PATH

{{< admonition type=tip title="技巧" open=true >}}
第一个变量值以`%`开头, 以`;`结束, 比如`%JAVA_HOME%\bin;`, 再次打开`Path`时就会显示为一行, 否则以列表形式显示。
{{< /admonition >}}

```
C:\Windows;
C:\Windows\system32;
C:\Windows\System32\OpenSSH\;
C:\Windows\System32\Wbem;
C:\Windows\System32\WindowsPowerShell\v1.0\;
C:\Program Files\dotnet\;
C:\Program Files (x86)\dotnet\;
C:\Program Files\Intel\Intel(R) Management Engine Components\iCLS\;
C:\Program Files (x86)\Intel\Intel(R) Management Engine Components\iCLS\;
C:\Program Files\Intel\Intel(R) Management Engine Components\DAL;
C:\Program Files (x86)\Intel\Intel(R) Management Engine Components\DAL;
C:\Program Files\Intel\Intel(R) Management Engine Components\IPT;
C:\Program Files (x86)\Intel\Intel(R) Management Engine Components\IPT;
C:\Program Files (x86)\NVIDIA Corporation\PhysX\Common;
D:\Android Platform Tools;
D:\Aria2;
D:\FFmpeg\bin;
D:\Git\cmd;
D:\Gradle\bin;
D:\Hugo;
D:\Microsoft VS Code\bin;
D:\NodeJS;
D:\NodeJS\node_global;
D:\NodeJS\yarn_global;
D:\Pandoc\;
%CATALINA_HOME%\bin;
%CATALINA_HOME%\lib;
%GRADLE_HOME%\bin;
%JAVA_HOME%\bin;
%MAVEN_HOME%\bin;
```

### 任务栏半透明

定位到注册表`HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced`, 新建`DWORD (32位) 值`, 命名为`UseOLEDTaskbarTransparency`, 修改数值数据为**1**(十六进制), 最后重启**explorer.exe**。


### 时间显示秒数

定位到注册表`HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced`, 新建`DWORD (32位) 值`, 命名为`ShowSecondsInSystemClock`, 修改数值数据为**1**(十六进制), 最后重启**explorer.exe**。

{{< admonition type=info title="注意" open=true >}}
Windows10可用, Windows11删除了这项功能。
{{< /admonition >}}

### 右键菜单检测文件哈希值

#### 添加

将以下内容写入一个`txt`中, 修改文件后缀名保存为`.reg`文件, 双击导入到注册表: 

```
Windows Registry Editor Version 5.00

[HKEY_CLASSES_ROOT\*\shell\Get-FileHash]
"MUIVerb"="Get-FileHash"
"SubCommands"=""
"Icon"="imageres.dll,312"

; MD5
[HKEY_CLASSES_ROOT\*\shell\Get-FileHash\Shell\MD5]
"MUIVerb"="MD5"
"Icon"="C:\\Windows\\system32\\WindowsPowerShell\\v1.0\\PowerShell.exe,0"

[HKEY_CLASSES_ROOT\*\shell\Get-FileHash\Shell\MD5\command]
@="PowerShell -NoExit -Command \"mode con cols=90 lines=15\";\"Get-FileHash -LiteralPath '%1' -Algorithm MD5 | Format-List\""

;SHA1
[HKEY_CLASSES_ROOT\*\shell\Get-FileHash\Shell\SHA1]
"MUIVerb"="SHA1"
"Icon"="C:\\Windows\\system32\\WindowsPowerShell\\v1.0\\PowerShell.exe,0"

[HKEY_CLASSES_ROOT\*\shell\Get-FileHash\Shell\SHA1\command]
@="PowerShell -NoExit -Command \"mode con cols=90 lines=15\";\"Get-FileHash -LiteralPath '%1' -Algorithm SHA1 | Format-List\""

;SHA256
[HKEY_CLASSES_ROOT\*\shell\Get-FileHash\Shell\SHA256]
"MUIVerb"="SHA256"
"Icon"="C:\\Windows\\system32\\WindowsPowerShell\\v1.0\\PowerShell.exe,0"

[HKEY_CLASSES_ROOT\*\shell\Get-FileHash\Shell\SHA256\command]
@="PowerShell -NoExit -Command \"mode con cols=90 lines=15\";\"Get-FileHash -LiteralPath '%1' -Algorithm SHA256 | Format-List\""
```

#### 移除

将以下内容写入一个`txt`中, 修改文件后缀名保存为`.reg`文件, 双击导入到注册表: 

```
Windows Registry Editor Version 5.00

[-HKEY_CLASSES_ROOT\*\shell\Get-FileHash]
```

## 软件参数

### Git

参考[Git Config](https://zhyoch.netlify.app/2020-7/)。

### Google Chrome

禁用Google Chrome Software Report Tool。

`C:\Users\UserName\AppData\Local\Google\Chrome\User Data\SwReporter\`

文件夹属性→安全→高级→禁用继承→从此对象中删除所有继承的权限。

{{< admonition type=quote title="参考链接" open=true >}}
1. [如何禁用 Software-Reporter-Tool](https://www.yikakia.com/%E5%A6%82%E4%BD%95%E7%A6%81%E7%94%A8Software-Reporter-Tool/)
2. [Chrome Enterprise Policy List & Management | Documentation](https://chromeenterprise.google/policies/#ChromeCleanupEnabled)
3. [Chrome Enterprise Policy List & Management | Documentation](https://chromeenterprise.google/policies/#ChromeCleanupReportingEnabled)
{{< /admonition >}}

### Maven

参考[Maven与Gradle的安装与配置](https://zhyoch.netlify.app/2020-2)。

### NodeJS

参考[NodeJS、NPM与Yarn的安装与配置](https://zhyoch.netlify.app/2021-10)。

## 重装开机步骤

1. 重装时不进行磁盘分区操作, 直接将系统安装在某块硬盘。
2. 开机使用离线模式。
3. 使用本地账户登录系统, 账户名使用英文。
4. 进行磁盘分区。
5. 更改`视频`、`图片`、`文档`、`下载`、`音乐`、`桌面`这些文件夹的位置。
6. 使用[Windows Defender Control](https://www.sordum.org/9480/defender-control-v2-0/)禁用Windows Defender。

    > 因为有次重装Windows10和11, 开机后`COM Surrogate`进程占用飙升, 全网搜索无果, 据我排查, 猜测是Windows Defender的锅。

7. 安装提前从官网下载到U盘的驱动。
8. 更改设置、控制面板等各种细节设置。
9. 安装卸载监控软件, 如[HiBit Uninstaller](https://www.hibitsoft.ir/), [Uninstall Tool](https://crystalidea.com/uninstall-tool/download)或[Geek Uninstaller](https://geekuninstaller.com/)
10. 卸载无用的Microsoft Store软件。
11. 安装软件。
12. 设置服务、任务计划程序、启用或关闭Windows功能、查看开机自启软件。
13. 设置各种系统参数、个性化的注册表和终端设置。


## 资源管理器视图调整

{{< image src="1.png" caption="资源管理器" height="auto" width="80%">}}

### 固定到快速访问

- 回收站
- 用户文件夹: `C:\Users\Username`
- 用户缓存文件夹: `C:\Users\Username\AppData\Local\Temp`

### 查看及排序

个人习惯将列调整为`名称`、`大小`、`修改日期`、`创建日期`和`类型`, **查看**为`详细信息`, **分组依据**为`类型→递减`, **排序方式**为`名称→递增`, 最后点击**文件夹选项**→**应用到文件夹**。

{{< image src="2.png" caption="调整列宽" height="auto" width="80%">}}

{{< image src="3.png" caption="文件夹选项" height="auto" width="50%">}}

#### “应用到文件夹”作用范围

{{< admonition type=info title="注意" open=true >}}
**文件夹选项**→**应用到文件夹**作用范围在不同情况下是不一样的, 毕竟提示说“你可以将此视图(如详细信息或图标)应用于**这种类型**的所有文件夹”。
{{< /admonition >}}

1. 磁盘分区的根目录是一种类型。在磁盘分区的根目录下使用“应用到文件夹”, 另外的磁盘分区根目录会出现同样的效果, 但是其子菜单无效果。比如在`D:\`应用, `C:\`和`E:\`有效果, 但`C:\abc`和`E:\abc`无效果。
2. 磁盘分区的子目录是一种类型。在磁盘分区的子目录下使用“应用到文件夹”, 这时另外的磁盘分区的子菜单终于有效果了。
3. `视频`、`图片`、`文档`、`下载`、`音乐`、`桌面`这些文件夹都代表各自的类型, 所以需要每一个都单独“应用到文件夹”一遍。
4. OneDrive以及其他特殊属性的文件夹需要单独“应用到文件夹”。